<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Shiny modules and helper functions for registry auto reports — autoReport • rapbase</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Shiny modules and helper functions for registry auto reports — autoReport"><meta name="description" content="These shiny modules may be used to set up auto reporting from registries at
Rapporteket."><meta property="og:description" content="These shiny modules may be used to set up auto reporting from registries at
Rapporteket."><meta property="og:image" content="/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rapbase</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">3.2.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Rapporteket/rapbase/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Shiny modules and helper functions for registry auto reports</h1>
      <small class="dont-index">Source: <a href="https://github.com/Rapporteket/rapbase/blob/v3.2.0/R/moduleAutoReport.R" class="external-link"><code>R/moduleAutoReport.R</code></a></small>
      <div class="d-none name"><code>autoReport.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These shiny modules may be used to set up auto reporting from registries at
Rapporteket.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">autoReportUI</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">autoReportOrgInput</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">autoReportOrgServer</span><span class="op">(</span><span class="va">id</span>, <span class="va">orgs</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">autoReportFormatInput</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">autoReportFormatServer</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">autoReportInput</span><span class="op">(</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">autoReportServer</span><span class="op">(</span></span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">registryName</span>,</span>
<span>  <span class="va">type</span>,</span>
<span>  org <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  paramNames <span class="op">=</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html" class="external-link">reactiveVal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  paramValues <span class="op">=</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html" class="external-link">reactiveVal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  reports <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  orgs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eligible <span class="op">=</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html" class="external-link">reactiveVal</a></span><span class="op">(</span><span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  freq <span class="op">=</span> <span class="st">"month"</span>,</span>
<span>  <span class="va">user</span>,</span>
<span>  runAutoReportButton <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">autoReportServer2</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>Character string providing the shiny module id.</p></dd>


<dt id="arg-orgs">orgs<a class="anchor" aria-label="anchor" href="#arg-orgs"></a></dt>
<dd><p>Named list of organizations (names) and ids (values). When set to
<code>NULL</code> (default) the ids found in auto report data will be used in the
table listing existing auto reports.</p></dd>


<dt id="arg-registryname">registryName<a class="anchor" aria-label="anchor" href="#arg-registryname"></a></dt>
<dd><p>Character string with the registry name key. Must
correspond to the registry R package name.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character string defining the type of auto reports. Must be one
of <code>c("subscription", "dispatchment", "bulletin")</code></p></dd>


<dt id="arg-org">org<a class="anchor" aria-label="anchor" href="#arg-org"></a></dt>
<dd><p>Shiny reactive or NULL (default) defining the organization (id)
of the data source used for dispatchments and bulletins (in which case it
cannot be set to NULL) and its value will be used to populate the
<em>organization</em> field in auto report data (autoReport.yml) for these
auto report types. On the other hand, since subscriptions are personal
(per user) the only relevant organization id will implicit be that of the
user and in this case any value of <code>org</code> will be disregarded.</p></dd>


<dt id="arg-paramnames">paramNames<a class="anchor" aria-label="anchor" href="#arg-paramnames"></a></dt>
<dd><p>Shiny reactive value as a vector of parameter names of
which values are to be set interactively at application run time. Each
element of this vector must match exactly those of <code>paramValues</code>.
Default value is <code>shiny::reactiveVal("")</code>.</p></dd>


<dt id="arg-paramvalues">paramValues<a class="anchor" aria-label="anchor" href="#arg-paramvalues"></a></dt>
<dd><p>Shiny reactive value as a vector of those parameter values
to be set interactively, <em>i.e.</em> as per user input in the application.
Default value is set to <code>shiny::reactiveVal("")</code> in which case
parameter values defined in <code>reports</code> will be used as is. In other
words, explicit use of <code>paramValues</code> will only be needed if parameter
values must be changed during application run time. If so, each element of
this vector must correspond exactly to those of <code>paramNames</code>.</p></dd>


<dt id="arg-reports">reports<a class="anchor" aria-label="anchor" href="#arg-reports"></a></dt>
<dd><p>List of a given structure that provides meta data for the
reports that are made available as automated reports. See Details for
further description.</p></dd>


<dt id="arg-eligible">eligible<a class="anchor" aria-label="anchor" href="#arg-eligible"></a></dt>
<dd><p>Logical defining if the module should be allowed to work at
full capacity. This might be useful when access to module products should
be restricted. Default is TRUE, <em>i.e.</em> no restrictions.</p></dd>


<dt id="arg-freq">freq<a class="anchor" aria-label="anchor" href="#arg-freq"></a></dt>
<dd><p>Character string defining default frequency set in the auto
report GUI. Must be one of
<code>c("day", "week", "month", "quarter", "year")</code>. Default value is
"month".</p></dd>


<dt id="arg-user">user<a class="anchor" aria-label="anchor" href="#arg-user"></a></dt>
<dd><p>List of shiny reactive values providing user metadata and
privileges corresponding to the return value of
<code><a href="navbarWidget.html">navbarWidgetServer</a></code>.</p></dd>


<dt id="arg-runautoreportbutton">runAutoReportButton<a class="anchor" aria-label="anchor" href="#arg-runautoreportbutton"></a></dt>
<dd><p>Logical defining if runAutoReport button should
be made available in the GUI. Default is FALSE. If TRUE, a button will be
made available to trigger running all auto reports for a given date. This
is mainly useful for testing purposes.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to autoReportServer function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>In general, shiny objects. In particular, <code>autoreportOrgServer</code>
returns a list with names "name" and "value" with corresponding reactive
values for the selected organization name and id. This may be used when
parameter values of auto report functions needs to be altered at application
run time.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <em>reports</em> argument must be a list where each entry
represents one report and its name will be used in the auto report user
interface for selecting reports, <em>e.g.</em>
<code>reports = list(MagicReport = ...)</code> will produce the entry "MagicReport"
in the GUI list of reports to select from. The value of each entry must be
another list with the following names and values:</p><dl><dt>synopsis</dt>
<dd><p>character string describing the report</p></dd>

  <dt>fun</dt>
<dd><p>report function base name (without"()")</p></dd>

  <dt>paramNames</dt>
<dd><p>character vector naming all arguments of <em>fun</em></p></dd>

  <dt>paramValues</dt>
<dd><p>vector with values corresponding to <em>paramNames</em></p></dd>


</dl><p>These named values will be used to run reports none-interactively on a given
schedule and must therefore represent existing and exported functions from
the registry R package. For subscriptions the <em>reports</em> list can be used
as is, more specifically that the values provided in <em>paramValues</em> can
go unchanged. It is likely that parameter values must be set dynamically at
runtime in which case <em>paramValues</em> must be a reactive part of the
application. See Examples on how function arguments may be used as reactives
in an application.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## make a list for report metadata</span></span></span>
<span class="r-in"><span><span class="va">reports</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  FirstReport <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    synopsis <span class="op">=</span> <span class="st">"First example report"</span>,</span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="st">"fun1"</span>,</span></span>
<span class="r-in"><span>    paramNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"organization"</span>, <span class="st">"topic"</span>, <span class="st">"outputFormat"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    paramValues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">111111</span>, <span class="st">"work"</span>, <span class="st">"html"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  SecondReport <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    synopsis <span class="op">=</span> <span class="st">"Second example report"</span>,</span></span>
<span class="r-in"><span>    fun <span class="op">=</span> <span class="st">"fun2"</span>,</span></span>
<span class="r-in"><span>    paramNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"organization"</span>, <span class="st">"topic"</span>, <span class="st">"outputFormat"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    paramValues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">111111</span>, <span class="st">"leisure"</span>, <span class="st">"pdf"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## make a list of organization names and numbers</span></span></span>
<span class="r-in"><span><span class="va">orgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  OrgOne <span class="op">=</span> <span class="fl">111111</span>,</span></span>
<span class="r-in"><span>  OrgTwo <span class="op">=</span> <span class="fl">222222</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## client user interface function</span></span></span>
<span class="r-in"><span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarLayout</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarPanel</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu">autoReportFormatInput</span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu">autoReportOrgInput</span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu">autoReportInput</span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">mainPanel</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu">autoReportUI</span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## server function</span></span></span>
<span class="r-in"><span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">org</span> <span class="op">&lt;-</span> <span class="fu">autoReportOrgServer</span><span class="op">(</span><span class="st">"test"</span>, <span class="va">orgs</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">format</span> <span class="op">&lt;-</span> <span class="fu">autoReportFormatServer</span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># set reactive parameters overriding those in the reports list</span></span></span>
<span class="r-in"><span>  <span class="va">paramNames</span> <span class="op">&lt;-</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"organization"</span>, <span class="st">"outputFormat"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">paramValues</span> <span class="op">&lt;-</span> <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">org</span><span class="op">$</span><span class="fu">value</span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu">autoReportServer2</span><span class="op">(</span></span></span>
<span class="r-in"><span>    id <span class="op">=</span> <span class="st">"test"</span>, registryName <span class="op">=</span> <span class="st">"rapbase"</span>, type <span class="op">=</span> <span class="st">"dispatchment"</span>,</span></span>
<span class="r-in"><span>    org <span class="op">=</span> <span class="va">org</span><span class="op">$</span><span class="va">value</span>, paramNames <span class="op">=</span> <span class="va">paramNames</span>, paramValues <span class="op">=</span> <span class="va">paramValues</span>,</span></span>
<span class="r-in"><span>    reports <span class="op">=</span> <span class="va">reports</span>, orgs <span class="op">=</span> <span class="va">orgs</span>, eligible <span class="op">=</span> <span class="cn">TRUE</span>, freq <span class="op">=</span> <span class="st">"month"</span>, <span class="va">user</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># run the shiny app in an interactive environment</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">shiny</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Are Edvardsen, Kevin Otto Thon, Arnfinn Hykkerud Steindal.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

